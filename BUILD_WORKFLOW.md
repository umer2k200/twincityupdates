# üöÄ Twin City Updates - Build Workflow

## Quick Build Commands

### For Web Development
```bash
# Build web version
npm run build:web

# Sync with Capacitor
npx cap sync
```

### For Android APK (EAS Build - Recommended)
```bash
# Build APK using EAS (cloud build)
npx eas build --platform android --profile preview

# For production build
npx eas build --platform android --profile production
```

### For Local Android Development (Requires Android Studio)
```bash
# Clean and build
npx expo run:android --no-build-cache

# Or using Gradle directly
cd android
./gradlew clean
./gradlew assembleDebug
```

## üîß Important Files (Don't Commit)

These files are gitignored for security reasons but are essential for builds:

### `.env` file (Create manually - for local development only)
```env
# News API Keys (REQUIRED for real news data)
EXPO_PUBLIC_NEWS_API_KEY=your_newsapi_key
EXPO_PUBLIC_GNEWS_API_KEY=your_gnews_api_key
EXPO_PUBLIC_WEATHER_API_KEY=your_weather_api_key

# Firebase Configuration
EXPO_PUBLIC_FIREBASE_API_KEY=your_api_key
EXPO_PUBLIC_FIREBASE_AUTH_DOMAIN=your_project.firebaseapp.com
EXPO_PUBLIC_FIREBASE_PROJECT_ID=your_project_id
EXPO_PUBLIC_FIREBASE_STORAGE_BUCKET=your_project.firebasestorage.app
EXPO_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your_sender_id
EXPO_PUBLIC_FIREBASE_APP_ID=your_app_id
EXPO_PUBLIC_GOOGLE_CLIENT_ID=your_client_id
```

**‚ö†Ô∏è IMPORTANT:** For production builds (EAS), you must set API keys as EAS secrets, not just in .env file. See `ENV_SETUP_GUIDE.md` for details.

### Android Build Files (Auto-generated)
- `android/` folder - Generated by Expo prebuild
- `google-services.json` - Firebase configuration

## üõ†Ô∏è Setup Requirements

### For EAS Build (Recommended)
1. Install EAS CLI: `npm install -g @expo/eas-cli`
2. Login: `eas login`
3. Configure: `eas build:configure`

### For Local Android Development
1. Install Android Studio
2. Install Android SDK
3. Set environment variables:
   - `ANDROID_HOME` = path to Android SDK
   - `JAVA_HOME` = path to JDK
   - Add `%ANDROID_HOME%\platform-tools` to PATH

## üêõ Common Issues & Solutions

### APK Crashes on Launch
1. ‚úÖ **Fixed**: Missing Firebase plugin configuration
2. ‚úÖ **Fixed**: Missing .env file with Firebase config
3. ‚úÖ **Fixed**: MainActivity theme not set
4. ‚úÖ **Fixed**: react-native-maps web compatibility

### Build Errors
- **Java not found**: Install JDK and set JAVA_HOME
- **Android SDK not found**: Install Android Studio and set ANDROID_HOME
- **Maps import error**: Fixed with Platform.OS check

## üì± Testing the APK

1. Download APK from EAS build link
2. Enable "Install from unknown sources" on Android device
3. Install and test the app
4. Check logs if issues occur: `adb logcat`

## üîÑ Complete Workflow for Next Time

```bash
# 1. Make your changes
# 2. Test web version
npm run build:web
npx cap sync

# 3. Commit changes
git add .
git commit -m "Your changes description"

# 4. Build APK
npx eas build --platform android --profile preview

# 5. Test and deploy
# Download APK from the provided link
```

## üìã Pre-build Checklist

- [ ] .env file exists with Firebase config
- [ ] All dependencies installed (`npm install`)
- [ ] Web build works (`npm run build:web`)
- [ ] No TypeScript errors
- [ ] Firebase configuration is correct
- [ ] All changes committed to git
